#include <iostream>
#include <limits.h>
using namespace std;

int porownania = 0;
int przypisania = 0;

void RESETUJ() {
    porownania = 0;
    przypisania = 0;
}

void MERGE(int A[], int p, int q, int r) {
    int n1 = q - p + 1;
    int n2 = r - q;

    int L[n1 + 1];
    int R[n2 + 1];

    for (int i = 0; i < n1; i++)
        L[i] = A[p + i];
        przypisania++;
    for (int j = 0; j < n2; j++)
        R[j] = A[q + 1 + j];
        przypisania++;

    L[n1] = INT_MAX;
    R[n2] = INT_MAX;
    przypisania +=2;

    int i = 0, j = 0;

    for (int k = p; k <= r; k++) {
        if (L[i] <= R[j]) {
            porownania++;
            A[k] = L[i];
            przypisania++;
            i++;
        } else {
            A[k] = R[j];
            porownania++;
            przypisania++;
            j++;
        }
    }
}

void MERGESORT(int A[], int p, int r) {
    if (p < r) {
        porownania++;
        int q = (p + r) / 2;
        MERGESORT(A, p, q);
        MERGESORT(A, q + 1, r);
        MERGE(A, p, q, r);
    }
}

void MERGE2(int A[], int p, int q1, int q2, int r) {
    int n1 = q1 - p + 1;
    int n2 = q2 - q1;
    int n3 = r - q2;

    int L[n1 + 1], M[n2 + 1], R[n3 + 1];

    for (int i = 0; i < n1; i++)
        L[i] = A[p + i];
        przypisania++;
    for (int j = 0; j < n2; j++)
        M[j] = A[q1 + 1 + j];
        przypisania++;
    for (int k = 0; k < n3; k++)
        R[k] = A[q2 + 1 + k];
        przypisania++;

    L[n1] = INT_MAX;
    M[n2] = INT_MAX;
    R[n3] = INT_MAX;
    przypisania +=3;

    int i = 0, j = 0, k = 0;

    for (int x = p; x <= r; x++) {
        if (L[i] <= M[j] && L[i] <= R[k]) {
            porownania++;
            A[x] = L[i];
            przypisania++;
            i++;
        } else if (M[j] <= L[i] && M[j] <= R[k]) {
            porownania++;
            A[x] = M[j];
            przypisania++;
            j++;
        } else {
            porownania++;
            A[x] = R[k];
            przypisania++;
            k++;
        }
    }
}

void MERGESORT2(int A[], int p, int r) {
    if (p < r) {
        porownania++;
        int q1 = p + (r - p) / 3;
        int q2 = p + 2 * (r - p) / 3;

        MERGESORT2(A, p, q1);
        MERGESORT2(A, q1 + 1, q2);
        MERGESORT(A, q2 + 1, r);

        MERGE2(A, p, q1, q2, r);
    }
}

void WYPISZ(int A[], int n) {
    for (int i = 0; i < n; i++) {
        cout << A[i] << " ";
    }
    cout << endl;
    cout << "Porownania: " << porownania << "\nPrzypisania: " << przypisania << "\n";
    RESETUJ();
    cout << endl;
}


int main() {
    int A1[] = {52, 54, 58, 62, 89, 75, 39, 38, 19, 81, 12, 80, 98, 37, 88, 52, 43, 94, 18, 89};
    int n1 = sizeof(A1) / sizeof(A1[0]);
    int A2[] = {2, 5, 52, 33, 40, 51, 75, 15, 3, 7, 97, 58, 42, 95, 59, 49, 84, 79, 83, 60, 43, 20, 40, 77, 16, 96, 28, 26, 7, 34, 16, 51, 43, 67, 64, 85, 67, 12, 30, 28};
    int n2 = sizeof(A2) / sizeof(A2[0]);
    int A3[] = {100, 26, 14, 77, 50, 47, 27, 88, 58, 56, 22, 49, 17, 83, 41, 43, 37, 18, 86, 96, 68, 6, 29, 68, 29, 43, 70, 82, 82, 21, 9, 68, 38, 12, 12, 67, 11, 4, 92, 99, 11, 37, 96, 38, 67, 21, 81, 76, 28, 6, 89, 64, 70, 28, 57, 72, 39, 47, 71, 67};
    int n3 = sizeof(A3) / sizeof(A3[0]);
    int A4[] = {53, 70, 15, 85, 46, 57, 9, 63, 15, 51, 25, 40, 47, 73, 97, 68, 3, 78, 41, 88, 18, 44, 68, 81, 5, 91, 50, 78, 2, 69, 6, 74, 55, 51, 78, 41, 21, 25, 8, 57, 71, 68, 53, 20, 58, 91, 19, 71, 26, 52, 81, 64, 74, 43, 69, 16, 32, 92, 40, 91, 32, 60, 82, 24, 40, 61, 93, 38, 28, 74, 76, 61, 94, 95, 6, 37, 70, 82, 26, 26};
    int n4 = sizeof(A4) / sizeof(A4[0]);
    int A5[] = {87, 83, 49, 96, 97, 6, 52, 56, 5, 72, 75, 25, 35, 85, 75, 30, 13, 10, 13, 42, 43, 1, 61, 60, 45, 37, 80, 57, 61, 31, 59, 2, 66, 58, 87, 94, 100, 51, 11, 17, 47, 22, 62, 83, 71, 21, 14, 76, 80, 52, 19, 90, 82, 14, 95, 84, 45, 51, 42, 71, 57, 22, 62, 13, 13, 17, 76, 31, 22, 15, 15, 75, 26, 34, 52, 26, 93, 75, 96, 69, 46, 29, 69, 54, 47, 28, 18, 29, 16, 81, 62, 50, 2, 13, 16, 41, 81, 50, 94, 2};
    int n5 = sizeof(A5) / sizeof(A5[0]);
    int A6[] = {7, 66, 92, 75, 22, 65, 21, 84, 45, 78, 84, 16, 49, 11, 10, 85, 59, 2, 49, 92, 36, 80, 81, 81, 1, 29, 5, 70, 86, 64, 67, 53, 22, 53, 57, 7, 78, 30, 97, 31, 74, 23, 58, 79, 55, 78, 77, 6, 1, 50, 83, 87, 88, 33, 31, 61, 24, 49, 77, 43, 24, 54, 59, 85, 2, 80, 82, 48, 6, 66, 65, 22, 16, 65, 33, 47, 63, 25, 97, 27, 82, 49, 22, 78, 50, 67, 39, 76, 23, 21, 49, 99, 69, 98, 85, 46, 97, 63, 63, 66, 96, 79, 78, 46, 14, 90, 61, 29, 69, 2, 65, 32, 25, 71, 45, 84, 63, 60, 100, 71};
    int n6 = sizeof(A6) / sizeof(A6[0]);

    MERGESORT(A1, 0, n1-1);
    WYPISZ(A1, n1);
    MERGESORT(A2, 0, n2-1);
    WYPISZ(A2, n2);
    MERGESORT(A3, 0, n3-1);
    WYPISZ(A3, n3);
    MERGESORT(A4, 0, n4-1);
    WYPISZ(A4, n4);
    MERGESORT(A5, 0, n5-1);
    WYPISZ(A5, n5);
    MERGESORT(A6, 0, n6-1);
    WYPISZ(A6, n6);

    cout << "Modyfikowane " <<endl <<endl;

    int B1[] = {52, 54, 58, 62, 89, 75, 39, 38, 19, 81, 12, 80, 98, 37, 88, 52, 43, 94, 18, 89};
    int m1 = sizeof(B1) / sizeof(B1[0]);
    int B2[] = {2, 5, 52, 33, 40, 51, 75, 15, 3, 7, 97, 58, 42, 95, 59, 49, 84, 79, 83, 60, 43, 20, 40, 77, 16, 96, 28, 26, 7, 34, 16, 51, 43, 67, 64, 85, 67, 12, 30, 28};
    int m2 = sizeof(B2) / sizeof(B2[0]);
    int B3[] = {100, 26, 14, 77, 50, 47, 27, 88, 58, 56, 22, 49, 17, 83, 41, 43, 37, 18, 86, 96, 68, 6, 29, 68, 29, 43, 70, 82, 82, 21, 9, 68, 38, 12, 12, 67, 11, 4, 92, 99, 11, 37, 96, 38, 67, 21, 81, 76, 28, 6, 89, 64, 70, 28, 57, 72, 39, 47, 71, 67};
    int m3 = sizeof(B3) / sizeof(B3[0]);
    int B4[] = {53, 70, 15, 85, 46, 57, 9, 63, 15, 51, 25, 40, 47, 73, 97, 68, 3, 78, 41, 88, 18, 44, 68, 81, 5, 91, 50, 78, 2, 69, 6, 74, 55, 51, 78, 41, 21, 25, 8, 57, 71, 68, 53, 20, 58, 91, 19, 71, 26, 52, 81, 64, 74, 43, 69, 16, 32, 92, 40, 91, 32, 60, 82, 24, 40, 61, 93, 38, 28, 74, 76, 61, 94, 95, 6, 37, 70, 82, 26, 26};
    int m4 = sizeof(B4) / sizeof(B4[0]);
    int B5[] = {87, 83, 49, 96, 97, 6, 52, 56, 5, 72, 75, 25, 35, 85, 75, 30, 13, 10, 13, 42, 43, 1, 61, 60, 45, 37, 80, 57, 61, 31, 59, 2, 66, 58, 87, 94, 100, 51, 11, 17, 47, 22, 62, 83, 71, 21, 14, 76, 80, 52, 19, 90, 82, 14, 95, 84, 45, 51, 42, 71, 57, 22, 62, 13, 13, 17, 76, 31, 22, 15, 15, 75, 26, 34, 52, 26, 93, 75, 96, 69, 46, 29, 69, 54, 47, 28, 18, 29, 16, 81, 62, 50, 2, 13, 16, 41, 81, 50, 94, 2};
    int m5 = sizeof(B5) / sizeof(B5[0]);
    int B6[] = {7, 66, 92, 75, 22, 65, 21, 84, 45, 78, 84, 16, 49, 11, 10, 85, 59, 2, 49, 92, 36, 80, 81, 81, 1, 29, 5, 70, 86, 64, 67, 53, 22, 53, 57, 7, 78, 30, 97, 31, 74, 23, 58, 79, 55, 78, 77, 6, 1, 50, 83, 87, 88, 33, 31, 61, 24, 49, 77, 43, 24, 54, 59, 85, 2, 80, 82, 48, 6, 66, 65, 22, 16, 65, 33, 47, 63, 25, 97, 27, 82, 49, 22, 78, 50, 67, 39, 76, 23, 21, 49, 99, 69, 98, 85, 46, 97, 63, 63, 66, 96, 79, 78, 46, 14, 90, 61, 29, 69, 2, 65, 32, 25, 71, 45, 84, 63, 60, 100, 71};
    int m6 = sizeof(B6) / sizeof(B6[0]);

    MERGESORT2(B1, 0, m1-1);
    WYPISZ(B1, m1);
    MERGESORT2(B2, 0, m2-1);
    WYPISZ(B2, m2);
    MERGESORT2(B3, 0, m3-1);
    WYPISZ(B3, m3);
    MERGESORT2(B4, 0, m4-1);
    WYPISZ(B4, m4);
    MERGESORT2(B5, 0, m5-1);
    WYPISZ(B5, m5);
    MERGESORT2(B6, 0, m6-1);
    WYPISZ(B6, m6);
    return 0;
}
